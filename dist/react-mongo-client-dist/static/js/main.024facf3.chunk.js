(this["webpackJsonpreact-mongo"]=this["webpackJsonpreact-mongo"]||[]).push([[0],{30:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),s=n(24),i=n.n(s),r=(n(30),n(7)),l=n.n(r),o=n(14),j=n(3),u=n(11),d=n.n(u),b=n(6),h=n(9),O=n(0),m=function(e){var t=e.handleLogin,n=e.loginLoading,a=e.loginFail,s=e.handleCloseLog,i=e.invalidEmail,r=e.handleCloseEmail,l=Object(c.useState)(""),o=Object(j.a)(l,2),u=o[0],d=o[1],m=Object(c.useState)(""),x=Object(j.a)(m,2),g=x[0],p=x[1],f=Object(c.useState)(!1),v=Object(j.a)(f,2),N=v[0],k=v[1];return Object(O.jsxs)("div",{className:"",children:[a?Object(O.jsxs)("div",{className:"alert-box bg-light-red p-3",children:["Login failed",Object(O.jsx)(h.a,{className:"align-right-icon",onClick:function(){s()}})]}):"",i?Object(O.jsxs)("div",{className:"alert-box bg-light-red p-3",children:["Invalid Email Address",Object(O.jsx)(h.a,{className:"align-right-icon",onClick:function(){r()}})]}):"",n?Object(O.jsx)("div",{className:"alert-box p-3 bg-primary text-white",children:"Logging in..."}):"",Object(O.jsxs)("div",{className:"",children:[Object(O.jsx)("h2",{children:"Login"}),Object(O.jsx)("label",{className:"h5",children:"Email"}),Object(O.jsx)("input",{type:"text",className:"form-control",placeholder:"Email",value:u,onChange:function(e){d(e.target.value)}}),Object(O.jsx)("label",{className:"h5",children:"Password"}),Object(O.jsx)("input",{type:N?"text":"password",className:"form-control",placeholder:"Password",value:g,onChange:function(e){p(e.target.value)}}),Object(O.jsx)("input",{type:"checkbox",checked:N,onChange:function(){k(!N)},id:"passCheckBox"}),Object(O.jsx)("label",{htmlFor:"passCheckBox",children:"Show password"}),Object(O.jsx)("button",{className:"btn text-white login-register-button my-2 d-block w-100",onClick:function(e){t(u,g)},children:"Login"}),Object(O.jsx)(b.b,{to:{pathname:"./register"},className:"d-block",children:"Don't have an account? Register here"})]})]})},x=function(e){var t=e.handleRegister,n=e.regLoading,a=e.regSuccess,s=e.handleCloseReg,i=(e.handleInvalidRegister,e.invalidRegister),r=e.handleInvalidRegisterClose,l=Object(c.useState)(""),o=Object(j.a)(l,2),u=o[0],d=o[1],m=Object(c.useState)(""),x=Object(j.a)(m,2),g=x[0],p=x[1],f=Object(c.useState)(""),v=Object(j.a)(f,2),N=v[0],k=v[1],C=Object(c.useState)(!1),S=Object(j.a)(C,2),w=S[0],y=S[1];return Object(O.jsxs)("div",{className:"",children:[n?Object(O.jsx)("div",{className:"alert-box bg-primary p-3 text-white",children:"Registering..."}):"",a?Object(O.jsxs)("div",{className:"alert-box bg-light-green p-3",children:["Registration successful",Object(O.jsx)(h.a,{className:"align-right-icon",onClick:function(){s()}})]}):"",i?Object(O.jsxs)("div",{className:"alert-box bg-light-red p-3",children:["Invalid Email Address",Object(O.jsx)(h.a,{className:"align-right-icon",onClick:function(){r()}})]}):"",Object(O.jsx)("h2",{children:"Register"}),Object(O.jsx)("label",{className:"h5 d-block",children:"Name"}),Object(O.jsx)("input",{type:"text",className:"form-control",placeholder:"Name",value:N,onChange:function(e){k(e.target.value)}}),Object(O.jsx)("label",{className:"h5 mt-2",children:"Email"}),Object(O.jsx)("input",{type:"email",className:"form-control",placeholder:"Email",value:u,onChange:function(e){d(e.target.value)}}),Object(O.jsx)("label",{className:"h5 mt-2",children:"Password"}),Object(O.jsx)("input",{type:w?"text":"password",className:"form-control",placeholder:"Password",value:g,onChange:function(e){p(e.target.value)}}),Object(O.jsx)("input",{className:"mt-2",type:"checkbox",checked:w,onChange:function(){y(!w)},id:"passCheckBox"}),Object(O.jsx)("label",{htmlFor:"passCheckBox",children:"Show password"}),Object(O.jsx)(b.b,{to:{pathname:""},children:Object(O.jsx)("button",{className:"btn text-white login-register-button my-2 d-block w-100",onClick:function(){t(u,g,N)},children:"Register"})}),Object(O.jsx)(b.b,{to:{pathname:"/"},children:"Have an account? Login here"})]})},g=n(25),p=function(e){var t=e.fruits;return Object(O.jsx)("option",{children:t.item})},f=function(e){var t=e.fruits,n=e.selectedFruit,c=e.setSelectedFruit;return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("label",{className:"h5",children:"Fruits"}),Object(O.jsx)("br",{}),Object(O.jsx)("select",{className:"mx-2",value:n,onChange:function(e){c(e.target.value)},children:t.map((function(e,t){return Object(O.jsx)(p,{fruits:e},t)}))})]})},v=function(e){var t=e.item,n=e.handleRemove,a=e.index,s=e.fruits,i=Object(c.useState)(0),r=Object(j.a)(i,2),l=r[0],o=r[1],u=s.find((function(e){return e.item===t}));return Object(O.jsxs)("div",{className:"p-2 my-2 dark-border row container text-center",children:[Object(O.jsxs)("div",{className:"col-3",children:[t,Object(O.jsxs)("div",{className:"",children:["Price: ",u.price]})]}),Object(O.jsx)("div",{className:"col-3",children:Object(O.jsx)("input",{min:0,type:"number",className:"",value:l,onChange:function(e){!function(e){o(parseInt(e.target.value)),u.count=parseInt(e.target.value)}(e)}})}),Object(O.jsx)("div",{className:"col-3",children:u.price*l}),Object(O.jsx)("div",{className:"col-3",children:Object(O.jsx)("button",{onClick:function(){return n(a)},children:"remove"})})]})},N=function(e){var t=e.results;return Object(O.jsxs)("div",{children:[Object(O.jsx)("h3",{children:"Transaction:"}),Object(O.jsxs)("h5",{children:["Name: ",t.userName]}),Object(O.jsx)("ol",{children:null!==t?t.items.map((function(e,t){return Object(O.jsx)("li",{children:e},t)})):""}),Object(O.jsxs)("h5",{children:["Total Price: ",t.price]})]})},k=function(e){var t=e.currentUser,n=e.fruits,a=Object(c.useState)("apple"),s=Object(j.a)(a,2),i=s[0],r=s[1],l=Object(c.useState)([]),o=Object(j.a)(l,2),u=o[0],d=o[1],h=function(e){var t=u.filter((function(t){return t!==u[e]}));console.log(n),d(t),console.log(p)},m=Object(c.useState)(null),x=Object(j.a)(m,2),p=x[0],k=x[1];return Object(O.jsxs)("div",{className:"shop",children:[Object(O.jsxs)("div",{className:"h4 d-block",children:["Hello ",t.name]}),Object(O.jsx)(f,{fruits:n,selectedFruit:i,setSelectedFruit:r}),Object(O.jsx)("button",{onClick:function(){return function(){for(var e in u)if(u[e]===i)return void console.log("dupe");d([].concat(Object(g.a)(u),[i]))}()},children:"Add"}),u.length>0?Object(O.jsxs)("div",{className:"row text-center",children:[Object(O.jsx)("div",{className:"col-3 h5",children:"Item"}),Object(O.jsx)("div",{className:"col-3 h5",children:"Count"}),Object(O.jsx)("div",{className:"col-3 h5",children:"Total Price"}),Object(O.jsx)("div",{className:"col-3 h5"})]}):"",u.map((function(e,t){return Object(O.jsx)(v,{item:e,index:t,handleRemove:h,fruits:n},t)})),u.length>0?Object(O.jsx)("button",{onClick:function(){var e=0;for(var c in n)e+=n[c].price*n[c].count,console.log(n[c].item,n[c].price,n[c].count);fetch("https://react-mongo-lloyd.herokuapp.com/api/transactions",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({name:t.name,items:u,total:e})}).then((function(e){return e.json()})).then((function(e){fetch("https://react-mongo-lloyd.herokuapp.com/api/transactions/"+e.data.insertedId).then((function(e){return e.json()})).then((function(e){return k(e.data)}))}))},children:"Buy"}):"",Object(O.jsx)(b.b,{to:{pathname:"/"},children:Object(O.jsx)("button",{children:"Logout"})}),null!==p?Object(O.jsx)(N,{results:p}):""]})},C=(n(51),n(2));var S=function(){var e="https://react-mongo-lloyd.herokuapp.com/api/",t=Object(c.useState)([]),n=Object(j.a)(t,2),a=n[0],s=n[1],i=Object(c.useState)(!1),r=Object(j.a)(i,2),u=r[0],h=r[1],g=Object(c.useState)(!1),p=Object(j.a)(g,2),f=p[0],v=p[1],N=Object(c.useState)(!1),S=Object(j.a)(N,2),w=S[0],y=S[1],R=Object(c.useState)(!1),L=Object(j.a)(R,2),F=L[0],E=L[1],I=Object(c.useState)(!1),P=Object(j.a)(I,2),B=P[0],T=P[1],A=Object(c.useState)(!1),z=Object(j.a)(A,2),J=z[0],Z=z[1],$=Object(c.useState)(!1),D=Object(j.a)($,2),H=D[0],U=D[1],M=Object(c.useState)(""),q=Object(j.a)(M,2),G=q[0],K=q[1],Q=function(){var t=Object(o.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return h(!0),t.next=3,d.a.get("".concat(e,"items"));case 3:n=t.sent,s(n.data.data),h(!1);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();Object(c.useEffect)((function(){Q()}),[]);var V=function(){var t=Object(o.a)(l.a.mark((function t(n,c,a){var s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(y(!1),v(!0),!te(n)){t.next=12;break}return t.next=5,d.a.post("".concat(e,"users"),{name:a,pass:c,email:n});case 5:s=t.sent,v(!1),y(!0),E(!1),console.log(s.data),t.next=13;break;case 12:W();case 13:case"end":return t.stop()}}),t)})));return function(e,n,c){return t.apply(this,arguments)}}(),W=function(){v(!1),E(!0)},X=function(){var t=Object(o.a)(l.a.mark((function t(n,c){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(T(!1),Z(!0),!te(n)){t.next=9;break}return t.next=5,d.a.post("".concat(e,"users/login"),{email:n,pass:c});case 5:null===(a=t.sent).data.data?_():ee(a.data),t.next=10;break;case 9:Y();case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Y=function(){Z(!1),U(!0),T(!1)},_=function(){console.log("no account found"),K(null),Z(!1),U(!1),T(!0)},ee=function(e){Z(!1),T(!1),U(!1),K(e.data),window.location.replace("./#/shop")},te=function(e){return/[a-zA-Z0-9!@#$%&'*+'-=]+@[a-zA-Z0-9!@#$%&'*+'-=]+\.[a-zA-Z0-9!@#$%&'*+'-=]+/.test(e)};return Object(O.jsx)(b.a,{children:Object(O.jsx)("div",{className:"container-sm w-50 my-2 p-3 dark-border",children:u?Object(O.jsx)("div",{children:"loading..."}):Object(O.jsxs)(C.c,{children:[Object(O.jsx)(C.a,{path:"/",element:Object(O.jsx)(m,{handleLogin:X,setRegSuccess:y,loginLoading:J,loginFail:B,invalidEmail:H,handleCloseLog:function(){T(!1)},handleCloseEmail:function(){U(!1)}})}),Object(O.jsx)(C.a,{path:"/register",element:Object(O.jsx)(x,{handleRegister:V,regLoading:f,handleCloseReg:function(){y(!1)},regSuccess:w,handleInvalidRegister:W,invalidRegister:F,handleInvalidRegisterClose:function(){E(!1)}})}),Object(O.jsx)(C.a,{path:"/shop",element:Object(O.jsx)(k,{currentUser:G,fruits:a})})]})})})},w=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,53)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),s(e),i(e)}))};i.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(S,{})}),document.getElementById("root")),w()}},[[52,1,2]]]);
//# sourceMappingURL=main.024facf3.chunk.js.map